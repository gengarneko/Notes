<html>
<head>
  <title>2.10 -- 实战分析: 评论功能 (六)</title>
  <basefont face="Consolas" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600363 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: Consolas;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1341"/>
<h1>2.10 -- 实战分析: 评论功能 (六)</h1>

<div>
<span><div>删除评论</div><div><br/></div><div>现在发布评论, 评论不会消失, 评论越来越多并不是什么好事. 所以我们给评论组件加上删除评论的功能, 这样就可以删除不想要的评论了. 修改 src/Comment.js 的 render 方法, 新增一个删除按钮:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  render () {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    const { comment } = this.props</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    return (</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      &lt;div className='comment'&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;div className='comment-user'&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          &lt;span className='comment-username'&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            {comment.username}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          &lt;/span&gt;：</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;/div&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;p&gt;{comment.content}&lt;/p&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;span className='comment-createdtime'&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          {this.state.timeString}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;/span&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;span className='comment-delete'&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          删除</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;/span&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      &lt;/div&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    )</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div></div><div><br/></div><div>我们在后面加了一个删除按钮, 因为 index.css 定义了样式, 所以鼠标放到特定的评论上面才会显示删除按钮, 让用户体验好一点</div><div><br/></div><div>我们知道评论列表数据是放在 CommentApp 当中的, 而这个删除按钮是在 Comment 当中的, 现在我们要做的事就是用户点击某条评论的删除按钮, 然后在 CommentApp 中把相应的数据删除. 但是 CommentApp 和 Comment 的关系是这样的:</div><div><br/></div><div><img src="2.10 -- 实战分析 评论功能 (六)_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>Comment 和 CommentApp 之间间隔了一个 CommentList, Comment 无法直接跟 CommentApp 打交道, 只能通过 CommentList 来转发这种删除评论的消息. 修改 Comment 组件, 让它可以把删除的消息传递到上一层:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">class Comment extends Component {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  static propTypes = {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    comment: PropTypes.object.isRequired,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    onDeleteComment: PropTypes.func,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    index: PropTypes.number</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  handleDeleteComment () {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    if (this.props.onDeleteComment) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      this.props.onDeleteComment(this.props.index)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  render () {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    ...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;span</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          onClick={this.handleDeleteComment.bind(this)}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          className='comment-delete'&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          删除</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;/span&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      &lt;/div&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    )</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div></div><div><br/></div><div>现在使用 Comment 的时候, 可以传入 onDeleteComment 和 index 两个参数. index 用来标志这个评论在列表的下标, 这样点击删除按钮的时候我们才能知道你点击的是哪个评论, 才能知道怎么从列表数据中删除. 用户点击删除会调用 handleDeleteComment, 它会调用从上层传入的 props.onDeleteComment 函数告知上一层组件删除的消息, 并且把评论下标传出去. 现在修改 src/CommentList.js 让它把这两个参数传进来.</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">class CommentList extends Component {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  static propTypes = {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    comments: PropTypes.array,</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    onDeleteComment: PropTypes.func</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  static defaultProps = {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    comments: []</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  handleDeleteComment (index) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    if (this.props.onDeleteComment) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      this.props.onDeleteComment(index)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  render() {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    return (</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      &lt;div&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        {</span><a href="http://this.props.comments.map((comment/" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">this.props.comments.map((comment</a><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">, i) =&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          &lt;Comment</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            comment={comment}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            key={i}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            index={i}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">            onDeleteComment={this.handleDeleteComment.bind(this)} /&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        )}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      &lt;/div&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    )</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div></div><div><br/></div><div>当用户点击按钮的时候, Comment 组件会调用 props.onDeleteComment, 也就是 CommentList 的 handleDeleteComment 方法. 而 handleDeleteComment 会调用 CommentList 所接受的配置参数中的 props.onDeleteComment, 并且把下标传出去.</div><div><br/></div><div>也就是说, 我们可以在 CommentApp 给 CommentList 传入一个 onDeleteComment 的配置参数来接受这个删除评论的消息, 修改 CommentApp.js:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  handleDeleteComment (index) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    console.log(index)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  render() {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    return (</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      &lt;div className='wrapper'&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;CommentInput onSubmit={this.handleSubmitComment.bind(this)} /&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;CommentList</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          comments={</span><a href="http://this.state.comments/" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">this.state.comments</a><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">          onDeleteComment={this.handleDeleteComment.bind(this)} /&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      &lt;/div&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    )</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div></div><div><br/></div><div>现在点击删除按钮, 可以在控制台看到评论对应的下标打印了出来. 其实这就是这么一个过程; CommentList 把下标 index 传给 Comment. 点击删除按钮的时候, Comment 把 index 传给了 CommentList, CommentList 再把它传给 CommentApp. 现在可以在 CommentApp 中删除评论了:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  handleDeleteComment (index) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    const comments =</span> <a href="http://this.state.comments/" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">this.state.comments</a></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    comments.splice(index, 1)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    this.setState({ comments })</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    this._saveComments(comments)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div></div><div><br/></div><div>我们通过 comment.splice 删除特定下标的评论, 并且通过 setState 重新渲染整个评论列表; 当然了, 还需要把最新的评论列表数据更新到 LocalStorage 中, 所以我们在删除, 更新后调用了 _saveComments 方法把数据同步到 LocalStorage 中.</div><div><br/></div><div>现在可以愉快地删除评论了, 但是, 删除评论后, 还没有清除评论的定时器, 修改 Comment.js, 新增生命周期 componentWillUnmount</div><div> 在评论组件销毁的时候清除定时器:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  componentWillUnmount () {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    clearInterval(this._timer)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div></div><div><br/></div><div>这才算完成了第五个需求</div><div><br/></div><div>显示代码块</div><div><br/></div><div>用户在输入内容中任何以 `` 包含的内容都会用 &lt;code&gt; 包含起来显示到页面上. &lt;code&gt; 这是一个 HTML 结构, 需要往页面动态插入 HTML 结构我们只能用 dangerouslySetHTML , 修改 sr/Comment.js, 把原来 render() 函数中的:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;p&gt;{comment.content}&lt;/p&gt;</span></div></div><div><br/></div><div>改成:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;p dangerouslySetInnerHTML={{</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  __html: this._getProcessedContent(comment.content)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}} /&gt;</span></div></div><div><br/></div><div>我们把经过 this._getProcessedContent 处理的评论内容以 HTML 的方式插入到 &lt;p&gt; 元素当中. this._getProcessedContent 要把 `` 包含的内容用 &lt;code&gt; 包裹起来, 一个正则表达式就可以做到了:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  _getProcessedContent (content) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    return content</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      .replace(/`([\S\s]+?)`/g, '&lt;code&gt;$1&lt;/code&gt;')</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div></div><div><br/></div><div>但是这样做会有严重的 XSS 漏洞, 用户可以输入任意的 HTMl 标签, 用 &lt;script&gt; 执行任意的 JavaScript 代码, 所以在替换代码之前, 我们要手动地把这些 HTML 标签进行转义:</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  _getProcessedContent (content) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    return content</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      .replace(/&amp;/g, &quot;&amp;amp;&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      .replace(/&lt;/g, &quot;&amp;lt;&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      .replace(/&gt;/g, &quot;&amp;gt;&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      .replace(/&quot;/g, &quot;&amp;quot;&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      .replace(/'/g, &quot;&amp;#039;&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">      .replace(/`([\S\s]+?)`/g, '&lt;code&gt;$1&lt;/code&gt;')</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">...</span></div></div><div><br/></div><div>前 5 个 replace 实际上是把类似于 &lt;, &gt; 这种内容替换转义一下, 防止用户输入 HTML 标签. 最后一行代码才是实现功能的代码.</div><div><br/></div><div>这时候在评论框中输入:</div><div><br/></div><div>这是代码块 `console.log`, 这是 &lt;h1&gt;正常内容&lt;/h1&gt;.</div><div><br/></div><div>然后点击发布, 看看效果:</div><div><br/></div><div><img src="2.10 -- 实战分析 评论功能 (六)_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>到此, 我们完成第二阶段</div><div><br/></div><div>总结</div><div><br/></div><div>到这里第二阶段已经全部结束, 我们已经掌握了全部的 React.js 实战需要的入门知识. 接下来我们会学习两个相对比较高级的 React.js 的概念, 然后进入 React-redux 的世界, 让它们配合 React.js 来构建更加成熟的前端页面.</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 