# 父子组件的数据传递



## 父组件向子组件传递数据

父组件通过 **属性（props）**向子组件传递数据。

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <link rel="stylesheet" href="">
    <script src="https://cdn.bootcss.com/vue/2.5.17/vue.js"></script>
</head> 
<body>
    <div id="app">
        <counter :count="0"></counter>
        <counter :count="1"></counter>
    </div>


    <script>

        var counter = {
            props: ['count'],
            template: '<div>{{ count }}</div>',
        }

        var vm = new Vue({
            el: '#app',
            components: {
                counter: counter
            }
            
        })
    </script>
</body>
</html>  
```

我们进行累加器的创建：

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <link rel="stylesheet" href="">
    <script src="https://cdn.bootcss.com/vue/2.5.17/vue.js"></script>
</head> 
<body>
    <div id="app">
        <counter :count="0"></counter>
        <counter :count="1"></counter>
    </div>


    <script>

        var counter = {
            props: ['count'],
            template: '<div @click="handleClick">{{ count }}</div>',
            methods: {
                handleClick: function() {
                    this.count ++
                }
            }
        }

        var vm = new Vue({
            el: '#app',
            components: {
                counter: counter
            }
            
        })
    </script>
</body>
</html>  
```

这时候可以实现累加功能，但是 Vue 会爆出警告，不要直接修改父组件传递过来的数据。

> 单向数据流：父组件可以向子组件传递参数，传递过的参数可以任意修改，但是子组件绝对不能反过来修改父组件的传递过来的参数。原因在于，一旦接受的不是基础类型数据，而是对象引用，这个对象引用被子组件修改后会影响到多个引用这个对象的组件。

解决方案：在子组件中的 data 里面复制一份父组件的值

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <link rel="stylesheet" href="">
    <script src="https://cdn.bootcss.com/vue/2.5.17/vue.js"></script>
</head> 
<body>
    <div id="app">
        <counter :count="0"></counter>
        <counter :count="1"></counter>
    </div>


    <script>

        var counter = {
            props: ['count'],
            data: function() {
                return {
                    number: this.count
                }
            }
            template: '<div @click="handleClick">{{ number }}</div>',
            methods: {
                handleClick: function() {
                    this.number ++
                }
            }
        }

        var vm = new Vue({
            el: '#app',
            components: {
                counter: counter
            }
            
        })
    </script>
</body>
</html>  
```





## 子组件向父组件传递数据

我们通过事件的方式来实现子组件向父组件传值。

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <link rel="stylesheet" href="">
    <script src="https://cdn.bootcss.com/vue/2.5.17/vue.js"></script>
</head>
<body>
    <div id="app">
        <counter @change="handleChange" :count="2"></counter>
        <counter @change="handleChange" :count="3"></counter>
        <div>
            {{ total }}
        </div>
    </div>


    <script>

        var counter = {
            props: ['count'],
            data: function() {
                return {
                    number: this.count
                }
            },
            template: '<div @click="handleClick">{{ number }}</div>',
            methods: {
                handleClick: function() {
                    this.number ++;
                    this.$emit('change', 1);
                }
            }
        }

        var vm = new Vue({
            el: '#app',
            data: {
                total: 0
            },
            components: {
                counter: counter
            },
            methods: {
                handleChange: function(step) {
                    this.total += step;
                }
						},
						mounted() {
							this.$nextTick(function () {
								// Code that will run only after the
								// entire view has been rendered
								this.handleChange(2)
								this.handleChange(3)
							})
						},

        })
    </script>
</body>
</html>
```

