# 浏览器的渲染：过程与原理

## 内容说明

本文不研究浏览器渲染的底层原理或前端优化具体细节的讲解，而是关于浏览器对页面的渲染——这一过程的描述及其背后原理的解释。这是因为前端优化是一个非常庞大且零散的知识集合。一篇文章如果要写优化的具体方法恐怕只能做一些有限的列举。

然而，如果了解清楚浏览器的渲染过程、渲染原理，其实就掌握了指导原则。根据优化原则，可以实现出无数种具体的优化方案，各种预编译、预加载、资源合并、按需加载都是针对浏览器渲染习惯的优化。

## 关键渲染路径

提到页面渲染，有几个相关度非常高的概念，最重要的是关键渲染路径，其他几个概念都可以从它展开，下面稍作说明。

**关键路径渲染（Critical Rendering Path）**是指与 <u>当前用户操作相关</u> 的内容。例如用户刚刚打开一个页面，首屏的显示就是当前用户操作相关的内容，具体就是浏览器收到 HTML、CSS 和 JavaScript 等资源并对其进行处理，从而渲染出 Web 页面。

了解浏览器渲染的过程与原理，很大程度上是为了**优化关键渲染路径**，但优化应该是针对具体问题的解决方案，所以优化没有一定之规。例如为了保证首屏内容的最快速显示，通常会提到渐进式页面渲染，但是为了渐进式页面渲染，就需要做资源的拆分，那么以什么粒度拆分、要不要拆分，不同页面、不同场景策略不同。具体方案的确既要考虑体验问题，也要考虑工程问题。

## 浏览器渲染页面的过程

从耗时的角度，浏览器请求、加载、渲染一个页面，时间都花在以下五件事上：

1. DNS查询
2. TCP 连接
3. HTTP 请求及响应
4. 服务器响应
5. 客户端响应

本文着重讨论第五部分，也就是浏览器对内容的渲染，这一部分（渲染树构建、布局及绘制），又可以分为下面五个步骤：

1. 处理 HTML 标记并构建 DOM 树。
2. 