<html>
<head>
  <title>1.1 -- 开发环境配置</title>
  <basefont face="Consolas" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600363 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: Consolas;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1425"/>
<h1>1.1 -- 开发环境配置</h1>

<div>
<span><div><span style="font-weight: bold;">编辑器选用 sublime text </span></div><div><br/></div><div>安装 Sublime Package Control</div><div><img src="1.1 -- 开发环境配置_files/5XgtK4bqOi.png" type="image/png" data-filename="5XgtK4bqOi.png"/></div><div><br/></div><div>执行以下代码:</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(135, 150, 168); font-family: &quot;Helvetica Neue&quot;, NotoSansHans-Regular, AvenirNext-Regular, arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 248, 252);">import urllib.request,os,hashlib; h = '6f4c264a24d933ce70df5dedcf1dcaee' + 'ebe013ee18cced0ef93d5f746d80ef60'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( '</span><a href="http://packagecontrol.io/" style="box-sizing: border-box; background: rgb(245, 248, 252); color: rgb(65, 131, 196); position: relative; font-family: &quot;Helvetica Neue&quot;, NotoSansHans-Regular, AvenirNext-Regular, arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">http://packagecontrol.io/</a><span style="color: rgb(135, 150, 168); font-family: &quot;Helvetica Neue&quot;, NotoSansHans-Regular, AvenirNext-Regular, arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(245, 248, 252);">' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); print('Error validating download (got %s instead of %s), please try manual install' % (dh, h)) if dh != h else open(os.path.join( ipp, pf), 'wb' ).write(by)</span></div></div><div>粘贴到Console中</div><div><br/></div><div>编码格式 EditorConfig</div><div>保证我们的编码风格统一,安装 EditorConfig 插件</div><div><img src="1.1 -- 开发环境配置_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>输入ins 自动补全,回车安装</div><div>输入Editor自动补全,回车安装</div><div><br/></div><div>底部状态栏可以查看安装状态</div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">命令行工具</span></div><div><br/></div><div>我们选用 Git for Windows ,下载后直接安装,默认设置</div><div><br/></div><div>编辑器设置命令行快捷访问</div><div>subl命令(通过命令行调用编辑器打开文件或者文件夹)</div><div>sublime专门提供了命令行工具 subl.exe 将安装目录直接添加到环境变量就行了,安装后重启电脑</div><div><img src="1.1 -- 开发环境配置_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>安装后输入如上内容,出现build编号说明 配置成功</div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">浏览器浏览器我们使用 Chrome</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">统一开发环境( Vagrant + Homestead )</span></div><div><br/></div><div>Homestead : 基于 Ubuntu 的虚拟机</div><div><br/></div><div><span style="font-weight: bold;">安装 VirtualBox 自行百度</span></div><div><br/></div><div><span style="font-weight: bold;">安装 Vagrant</span> </div><div>    ( 管理虚拟机的工具,支持当前主流虚拟机系统,作用主要是提供一个可配置,可移植和可复用的软件环境 )</div><div>    让你编写一个 Vagrantifile 文件来控制虚拟机的启动,虚拟网络环境的配置,虚拟机与主机间的文件共享,以及启动后自动执行一些配置于脚本.比如自动执行一个 shell script 来安装一些必备的开发工具,如安装 MySQL PHP 甚至自动配置 Nginx 站点</div><div>    意味着在多人开发的项目中,只要同步 Vagrantifle 文件,就可以保证每个人的机器上拥有一致的开发环境</div><div><br/></div><div>Homestead介绍</div><div>    利用 Vagrantifle 提供的便利,定制了一套可配置,可移植,可复用的 Laravel 开发环境 </div><div>    Homestead 虚拟机包含了 Nginx Web 服务器, PHP 7 , Postgres, Redis , Memcached , Node 以及各种软件</div><div>    包含了两个东西: Homestead 管理脚本 HomesteadBox 虚拟机盒子</div><div>    管理脚本:</div><div>        使用 Ruby 和 Shell 脚本写成的,原理是对 Vagrantifile 文件做定制.</div><div>        将从 ~/Homestead/Homestead.yaml 读取得的配置信息,在 provision 时,解析为 Vagrant 命令并进行对虚拟机的配置</div><div>        脚本作用在于,提供了及其简单易用的接口,使我们只需要通过傻瓜化配置,即可完成复杂的任务,以下是常用任务:</div><div>            IP 配置 , 端口映射</div><div>            Nginx Site 创建</div><div>            数据库创建</div><div>            主机文件夹挂在到虚拟机等任务</div><div>        我们使用定制版本的 Homestead </div><div><br/></div><div>Homestead Box 虚拟机盒子</div><div>    是提前打包好的 vagrant box 虚拟机盒子,里面预装了 Nginx 服务器, php7 mysql postgres redis memcached node</div><div>    </div><div><br/></div><div>安装和使用 Homestead </div><div>    下载和导入 Homestead Box 虚拟机盒子</div><div>    安装 git 为下载 Homestead 管理脚本做准备</div><div>    使用 git 下载 Homestead 管理脚本</div><div><br/></div><div>下载 Homestead 虚拟机盒子</div><div>    <a href="http://download.fsdhub.com/lc-homestead-6.1.0-2018061700.zip">http://download.fsdhub.com/lc-homestead-6.1.0-2018061700.zip</a>  建议迅雷下载</div><div>在解压目录中 lc-homestead-6.1.0-2018061700 输入 vagrant box add metadata.json</div><div>    <img src="1.1 -- 开发环境配置_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>完成 Homestead Box 的导入</div><div><br/></div><div>安装 git (也可以先安装 git )</div><div>    <img src="1.1 -- 开发环境配置_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-weight: bold;">下载 Homestead 管理脚本</span></div><div>    使用 git </div><div>    输入 git clone <a href="https://git.coding.net/summerblue/homestead.git">https://git.coding.net/summerblue/homestead.git</a> Homestead  下载</div><div>    <img src="1.1 -- 开发环境配置_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>使用命令进入 Homestead 目录 使用 git 检测出我们需要的 Homestead 版本</div><div>    <img src="1.1 -- 开发环境配置_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>初始化 Homestead </div><div>    <img src="1.1 -- 开发环境配置_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>运行完成后 生成三个文件</div><div>    Homestead.yaml ( 主要配置信息文件 配置站点和数据库等信息 )</div><div>    after.sh ( 每次 homestead 盒子重置后会调用的 shell 脚本) </div><div>    aliases ( 每次盒子重置后,替换至虚拟机的~/.bash_aliases中,aliases 里可以放一些快捷命令的定义 )</div><div><br/></div><div>homestead.yaml 配置文件</div><div>    cd ~/Homestead/</div><div>    subl ~/Homestead/Hommestead.yaml 快速打开文件</div><div>yaml文件中的内容</div><div>    虚拟机设置；(我们不需要任何设置)</div><div>    SSH 秘钥登录配置；(默认填写即可)</div><div>    共享文件夹配置；</div><div>    站点配置；</div><div>    数据库配置；</div><div>    自定义变量；</div><div><br/></div><div>keys是数组选项,填写的是本机额 SSH 私钥文件地址. </div><div>    虚拟机初始化时,会将此处填写的所有 SSH 私钥文件复制到虚拟机的 /home/vagranrt/.ssh/ 文件中,从而虚拟机能共享主机上的 SSH 私钥文件,使虚拟机具备等同于主机的身份认证. `此功能为 SSH 授权提供了便利,只需要在github上配置一个 ssh 公钥,即可实现 GitHub 对虚拟机和主机共同认证</div><div><br/></div><div>将公钥和私钥一起同步到虚拟机中</div><div>    <img src="1.1 -- 开发环境配置_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>生成 ssh key </div><div>    先检查是否已经生成过 key </div><div>        ls -al ~/.ssh</div><div>    如果没有,使用下面方法生成  ssh key </div><div>        ssh-keygen -t rsa -C &quot;<a href="mailto:your_email@example.com">your_email@example.com</a>&quot;</div><div>        Generating public/private rsa key pair.</div><div>    <img src="1.1 -- 开发环境配置_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>    <img src="1.1 -- 开发环境配置_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>共享文件夹配置</div><div>    通过 folders 来指明本机要映射到 虚拟机上的文件夹</div><div>    map 对应我们本机的文件夹</div><div>    to 对应的 Homestead 上的文件夹</div><div>    <img src="1.1 -- 开发环境配置_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div>    默认 Homestead 会将我们本机的 ~/Code 文件夹映射到 /home/vagrant/Code 文件夹上</div><div>    我们来新建一个 Code文件夹</div><div><br/></div><div>    以后我们将自己的laravel 项目文件放置到此目录下, Homestead 会将该文件夹下的项目自动映射到虚拟机的  /home/vagrant/Code 文件夹上</div><div>    </div><div>站点配置</div><div>    站点配置允许在主机里,通过域名访问虚拟机上的 laravel 应用</div><div>    sites 配置所示 将 homestead.test 映射到一个laravel项目的 public 目录上,</div><div>    这一行配置,会命令 Homestead 为我们新建一个 Nginx 站点,并把 Web Root 配置到指定目录下</div><div>    Laravel 应用的 Nginx 站点 Web Root 配置,默认就在根目录下的 public 目录</div><div>    <img src="1.1 -- 开发环境配置_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>    主机里直接访问虚拟机站点,必须绑定 hosts 来实现. 下面利用  hosts 文件绑定 homestead.test 到虚拟机 ip 192.168.10.10 上 </div><div>    hosts 文件路径 : C:/Windows/System32/Drivers/etc/hosts</div><div>    在文件 hosts 最后加入下面一行:</div><div>        192.168.10.10 homestead.test</div><div><img src="1.1 -- 开发环境配置_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>至此 站点配置完成 创建 laravel 项目后,即可通过浏览器访问 homestead.test 站点</div><div><br/></div><div>数据库配置</div><div>    <img src="1.1 -- 开发环境配置_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div>    使用默认配置</div><div>    </div><div><br/></div><div>自定义变量</div><div>    如果需要自己定义一些虚拟机上的可以使用的自定义变量 可以在 variables 中进行定义</div><div>    <img src="1.1 -- 开发环境配置_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>    自定义变量不进行使用,了解即可</div><div><br/></div><div>运行 Vagrant</div><div>    完成对 Homestead 的配置 接下来我们需要启动虚拟机</div><div>    命令中输入 vagrant ,能看到 Vagrant 为我们提供的一些便利的命令行,</div><div>    <img src="1.1 -- 开发环境配置_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>    启动 Homestead </div><div>        cd ~/Homestead &amp;&amp; vagrant up</div><div>        <img src="1.1 -- 开发环境配置_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div>        第一次启动, vagrant 会做以下几件事:</div><div>            以导入 homestead 虚拟机盒子为模板,新建一台虚拟机</div><div>            按照 .yaml 里的配置信息,对新建虚拟机进行配置</div><div>            配置完成后启动虚拟机</div><div>        成功启动后,还是在 ~/Homestead 目录里,通过以下命令 SSH 登录 Homestead 虚拟机中</div><div>            vagrant ssh</div><div>            <img src="1.1 -- 开发环境配置_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>        看到以上界面,至此 环境配置完成!</div><div>            exit 推出虚拟机</div><div>            vagrant halt 关闭homestead</div><div><br/></div><div><img src="1.1 -- 开发环境配置_files/Image [18].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 